<section class="list-ui">
  <header class="list-ui__header">
    <div class="list-ui__header-left">
      <h2 class="list-ui__title">Transacciones</h2>
      <p class="list-ui__subtitle">Lista de compras y ventas registradas.</p>
    </div>

    <div class="list-ui__header-right">
      <button class="list-ui__btn list-ui__btn--primary" type="button" (click)="irNuevo()">
        + Nuevo
      </button>
    </div>
  </header>

  <div class="list-ui__toolbar">
    <div class="list-ui__search">
      <input
        class="list-ui__search-input"
        type="text"
        [value]="search"
        (input)="onSearchInput($event)"
        placeholder="Buscar por tipo, detalle o producto..."
      />
    </div>

    <div class="list-ui__filters">
      <label class="list-ui__filter">
        <span class="list-ui__filter-label">Filas</span>
        <select class="list-ui__filter-select" (change)="cambiarRowCount($event)">
          <option value="5" [selected]="grid.rowCount === 5">5</option>
          <option value="10" [selected]="grid.rowCount === 10">10</option>
          <option value="25" [selected]="grid.rowCount === 25">25</option>
        </select>
      </label>
    </div>
  </div>

  <div class="list-ui__card">
    <div class="list-ui__loading" *ngIf="cargando">
      <span class="list-ui__loading-dot"></span>
      <span class="list-ui__loading-text">Cargando...</span>
    </div>

    <div class="list-ui__empty" *ngIf="!cargando && !hayDatos">
      <div class="list-ui__empty-icon">üßæ</div>
      <h3 class="list-ui__empty-title">Sin transacciones</h3>
      <p class="list-ui__empty-subtitle">No hay registros para mostrar con los filtros actuales.</p>

      <button class="list-ui__btn list-ui__btn--primary" type="button" (click)="irNuevo()">
        Crear transacci√≥n
      </button>
    </div>

    <table class="list-ui__table" *ngIf="!cargando && hayDatos">
      <thead class="list-ui__thead">
      <tr>
        <th class="list-ui__th list-ui__th--sortable" (click)="ordenar('Fecha')">
          Fecha <span class="list-ui__sort">{{ sortIcon('Fecha') }}</span>
        </th>

        <th class="list-ui__th list-ui__th--sortable" (click)="ordenar('Tipo')">
          Tipo <span class="list-ui__sort">{{ sortIcon('Tipo') }}</span>
        </th>

        <th class="list-ui__th list-ui__th--sortable" (click)="ordenar('ProductoId')">
          Producto <span class="list-ui__sort">{{ sortIcon('ProductoId') }}</span>
        </th>

        <th class="list-ui__th list-ui__cell--right list-ui__th--sortable" (click)="ordenar('Cantidad')">
          Cant. <span class="list-ui__sort">{{ sortIcon('Cantidad') }}</span>
        </th>

        <th class="list-ui__th list-ui__cell--right list-ui__th--sortable" (click)="ordenar('PrecioUnitario')">
          Unitario <span class="list-ui__sort">{{ sortIcon('PrecioUnitario') }}</span>
        </th>

        <th class="list-ui__th list-ui__cell--right list-ui__th--sortable" (click)="ordenar('PrecioTotal')">
          Total <span class="list-ui__sort">{{ sortIcon('PrecioTotal') }}</span>
        </th>

        <th class="list-ui__th">Detalle</th>
        <th class="list-ui__th list-ui__cell--right">Acciones</th>
      </tr>
      </thead>

      <tbody class="list-ui__tbody">
      <tr class="list-ui__row" *ngFor="let t of grid.rows">
        <td class="list-ui__td">{{ t.fecha }}</td>

        <td class="list-ui__td">
          <span class="list-ui__badge" [ngClass]="t.tipoTransaccion === 'COMPRA' ? 'list-ui__badge--inactive' : 'list-ui__badge--active'">
            {{ t.tipoTransaccion }}
          </span>
        </td>

        <td class="list-ui__td">
          {{ t.productoNombre || ('#' + t.IdProducto) }}
        </td>

        <td class="list-ui__td list-ui__cell--right">{{ t.cantidad }}</td>

        <td class="list-ui__td list-ui__cell--right">
          $ {{ t.precioUnitario | number:'1.2-2' }}
        </td>

        <td class="list-ui__td list-ui__cell--right">
          $ {{ t.precioTotal | number:'1.2-2' }}
        </td>

        <td class="list-ui__td">
          <span *ngIf="t.detalle; else sinDetalle">{{ t.detalle }}</span>
          <ng-template #sinDetalle>-</ng-template>
        </td>

        <td class="list-ui__td list-ui__cell--right">
          <div class="list-ui__actions">
            <button class="list-ui__icon-btn" type="button" title="Editar" (click)="irEditar(t.id)">‚úèÔ∏è</button>
          </div>
        </td>
      </tr>
      </tbody>
    </table>

    <footer class="list-ui__footer" *ngIf="!cargando">
      <span class="list-ui__footer-left">{{ rangoTexto }}</span>

      <div class="list-ui__pager" *ngIf="totalPaginas > 1">
        <button class="list-ui__pager-btn" type="button" [disabled]="grid.current === 1" (click)="cambiarPagina(1)">¬´</button>
        <button class="list-ui__pager-btn" type="button" [disabled]="grid.current === 1" (click)="cambiarPagina(grid.current - 1)">‚Äπ</button>

        <span class="list-ui__pager-info">
          P√°gina {{ grid.current }} / {{ totalPaginas }}
        </span>

        <button class="list-ui__pager-btn" type="button" [disabled]="grid.current === totalPaginas" (click)="cambiarPagina(grid.current + 1)">‚Ä∫</button>
        <button class="list-ui__pager-btn" type="button" [disabled]="grid.current === totalPaginas" (click)="cambiarPagina(totalPaginas)">¬ª</button>
      </div>
    </footer>
  </div>
</section>
